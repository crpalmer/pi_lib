include(../platform.cmake)

function(util_common targetName)
    platform_executable(${targetName})

    target_include_directories(${targetName} PRIVATE . .. ../${PLATFORM})
    target_link_directories(${targetName} PRIVATE ..)
    target_link_libraries(${targetName} PRIVATE pi)
endfunction()

function(util_c targetName)
    add_executable(${targetName} ${targetName}.c ${ARGV})
    util_common(${targetName})
endfunction()

function(util_cpp targetName)
    add_executable(${targetName} ${targetName}.cpp ${ARGV})
    util_common(${targetName})
endfunction()

if("${PLATFORM}" STREQUAL pico)
  util_cpp(ble)
  util_cpp(light-sensor)
  util_cpp(neopixel-pico)
  util_cpp(notes)
else()
  util_cpp(digital-counter)
  util_c(maestro)
  util_cpp(neopixel-pi)
  util_c(nes-dump)
  util_cpp(st7735s)
  util_c(talking-skull-dump)
  util_c(talking-skull-prepare)
  util_c(wb)
endif()

util_cpp(adc)
util_cpp(gp-input)
util_cpp(life)
util_cpp(mcp23017)
util_cpp(rotary-encoder)
# TODO: util_cpp(servo)
util_cpp(ssd1306)
